# Как отключить поддержку 16 KB страниц в эмуляторе Android

## Проблема
Yandex MapKit 4.5.1 не поддерживает 16 KB страницы памяти, что вызывает ошибку при запуске приложения на эмуляторе с поддержкой 16 KB.

## Решение 1: Использовать обычный системный образ (без 16 KB)

### Шаг 1: Проверьте текущий размер страниц
1. Запустите эмулятор
2. Откройте терминал в Android Studio (внизу)
3. Выполните команду:
   ```bash
   adb shell getconf PAGE_SIZE
   ```
   - Если вернулось `4096` - используется 4 KB (нормально)
   - Если вернулось `16384` - используется 16 KB (проблема)

### Шаг 2: Измените системный образ эмулятора
1. Откройте **AVD Manager**:
   - **Tools → Device Manager** (или **Tools → AVD Manager** в старых версиях)
2. Найдите ваш эмулятор **Pixel 5**
3. Нажмите на иконку **карандаша** (Edit) справа от эмулятора
4. В окне редактирования нажмите **Show Advanced Settings** (если доступно)
5. Или нажмите **Next** до раздела **System Image**
6. Выберите системный образ **БЕЗ** пометки "16 KB Page Size":
   - ✅ **Google APIs Intel x86_64 Atom System Image** (API 34)
   - ✅ **Google APIs ARM 64 v8a System Image** (API 34)
   - ❌ НЕ выбирайте: "Google APIs Experimental 16 KB Page Size..."
7. Нажмите **Finish**
8. Перезапустите эмулятор

## Решение 2: Запуск эмулятора с флагом для отключения 16 KB

### Через командную строку:
1. Найдите путь к эмулятору (обычно):
   ```
   C:\Users\ВашеИмя\AppData\Local\Android\Sdk\emulator
   ```
2. Откройте PowerShell или Command Prompt
3. Перейдите в папку эмулятора:
   ```powershell
   cd "C:\Users\ВашеИмя\AppData\Local\Android\Sdk\emulator"
   ```
4. Найдите имя вашего AVD:
   ```powershell
   emulator -list-avds
   ```
5. Запустите эмулятор с флагом для использования 4 KB страниц:
   ```powershell
   emulator -avd Pixel_5_API_34 -page-size 4096
   ```
   (Замените `Pixel_5_API_34` на реальное имя вашего AVD)

## Решение 3: Создать новый эмулятор без поддержки 16 KB

1. Откройте **AVD Manager**: **Tools → Device Manager**
2. Нажмите **Create Device**
3. Выберите **Pixel 5** (или другое устройство)
4. Нажмите **Next**
5. В разделе **System Image**:
   - Убедитесь, что выбрана вкладка **Recommended** или **x86 Images**
   - Выберите системный образ **БЕЗ** пометки "16 KB Page Size":
     - ✅ **Google APIs** (API 34) - Android 14.0
     - ✅ **Google Play** (API 34) - Android 14.0
     - ❌ НЕ выбирайте: "Google APIs Experimental 16 KB Page Size..."
6. Нажмите **Next** → **Finish**
7. Запустите новый эмулятор

## Решение 4: Изменить конфигурационный файл эмулятора

1. Найдите файл конфигурации вашего AVD:
   ```
   C:\Users\ВашеИмя\.android\avd\Pixel_5_API_34.avd\config.ini
   ```
   (Замените `Pixel_5_API_34` на реальное имя вашего AVD)

2. Откройте файл `config.ini` в текстовом редакторе

3. Найдите строку (если есть):
   ```
   hw.ramSize = 2048
   ```

4. Добавьте или измените строку:
   ```
   disk.dataPartition.size = 4096M
   ```

5. Сохраните файл и перезапустите эмулятор

## Проверка результата

После применения любого из решений:

1. Запустите эмулятор
2. Откройте терминал в Android Studio
3. Выполните:
   ```bash
   adb shell getconf PAGE_SIZE
   ```
4. Должно вернуться `4096` (4 KB)

## Альтернативное решение: Обновить Yandex MapKit

Когда Yandex выпустит версию MapKit с поддержкой 16 KB страниц, обновите зависимость в `app/build.gradle.kts`:

```kotlin
// Текущая версия (не поддерживает 16 KB)
implementation("com.yandex.android:maps.mobile:4.5.1-full")

// Будущая версия (когда будет доступна)
// implementation("com.yandex.android:maps.mobile:4.6.0-full")
```

## Примечание

- Для разработки можно использовать эмулятор с 4 KB страницами
- Для публикации в Google Play после ноября 2025 года потребуется поддержка 16 KB
- К тому времени Yandex должен выпустить обновленную версию MapKit
