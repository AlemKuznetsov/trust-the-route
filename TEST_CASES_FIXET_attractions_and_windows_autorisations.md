# Тест-кейсы: Исправления маркеров достопримечательностей и авторизации

## Общая информация
**Дата создания:** 2026-01-22  
**Версия приложения:** Текущая  
**Тестируемые компоненты:** 
- YandexMapView (маркеры достопримечательностей и местоположения)
- Авторизация при запуске приложения
- Карточки описания маршрута
- Кнопка определения местоположения

---

## Раздел 1: Маркеры достопримечательностей

### TC-ATT-001: Отображение маркеров достопримечательностей на карте
**Приоритет:** Высокий  
**Предусловия:**
- Пользователь авторизован
- Загружен маршрут с достопримечательностями
- Карта открыта

**Шаги:**
1. Открыть приложение
2. Выбрать маршрут (например, "Автобус Б")
3. Перейти на экран карты
4. Дождаться загрузки маршрута и достопримечательностей

**Ожидаемый результат:**
- На карте отображаются золотистые маркеры достопримечательностей
- Маркеры видны и имеют правильный цвет (#ffaf24)
- Количество маркеров соответствует количеству достопримечательностей в маршруте
- Маркеры не исчезают при обновлении местоположения

**Фактический результат:** [Заполняется тестировщиком]

---

### TC-ATT-002: Размер маркеров достопримечательностей
**Приоритет:** Средний  
**Предусловия:**
- Маршрут загружен
- Карта открыта
- Маркеры отображаются

**Шаги:**
1. Открыть карту с маршрутом
2. Наблюдать размер маркеров достопримечательностей

**Ожидаемый результат:**
- Маркеры имеют размер 63% от исходного размера (scale = 0.63f)
- Маркеры хорошо видны, но не слишком большие
- Размер маркеров одинаковый для всех достопримечательностей

**Фактический результат:** [Заполняется тестировщиком]

---

### TC-ATT-003: Стабильность маркеров при обновлении местоположения
**Приоритет:** Высокий  
**Предусловия:**
- Маршрут загружен
- Карта открыта
- Маркеры достопримечательностей отображаются
- Разрешение на геолокацию предоставлено

**Шаги:**
1. Открыть карту с маршрутом
2. Убедиться, что маркеры достопримечательностей видны
3. Нажать кнопку определения местоположения
4. Дождаться обновления местоположения (несколько раз)
5. Наблюдать за маркерами достопримечательностей

**Ожидаемый результат:**
- Маркеры достопримечательностей остаются на карте при обновлении местоположения
- Маркеры не исчезают и не мигают
- Количество маркеров не изменяется

**Фактический результат:** [Заполняется тестировщиком]

---

### TC-ATT-004: Клик по маркеру достопримечательности
**Приоритет:** Высокий  
**Предусловия:**
- Маршрут загружен
- Карта открыта
- Маркеры отображаются

**Шаги:**
1. Открыть карту с маршрутом
2. Найти маркер достопримечательности на карте
3. Нажать на маркер

**Ожидаемый результат:**
- При клике на маркер открывается карточка достопримечательности
- Карточка содержит правильную информацию о достопримечательности
- userData маркера корректно установлен (проверка через логи)

**Фактический результат:** [Заполняется тестировщиком]

---

## Раздел 2: Авторизация при запуске

### TC-AUTH-001: Отсутствие экрана авторизации для авторизованного пользователя
**Приоритет:** Критический  
**Предусловия:**
- Пользователь ранее авторизовался в приложении
- Токен авторизации сохранен

**Шаги:**
1. Закрыть приложение полностью
2. Запустить приложение заново
3. Наблюдать за начальным экраном

**Ожидаемый результат:**
- Экран авторизации НЕ показывается даже на доли секунды
- Приложение сразу открывается на главном меню
- Пользователь не видит экран логина

**Фактический результат:** [Заполняется тестировщиком]

---

### TC-AUTH-002: Показ экрана авторизации для неавторизованного пользователя
**Приоритет:** Высокий  
**Предусловия:**
- Пользователь не авторизован
- Токен авторизации отсутствует

**Шаги:**
1. Выйти из приложения (если авторизован)
2. Очистить данные приложения или удалить токен
3. Запустить приложение

**Ожидаемый результат:**
- Приложение открывается на экране авторизации
- Экран логина отображается корректно

**Фактический результат:** [Заполняется тестировщиком]

---

## Раздел 3: Определение местоположения

### TC-LOC-001: Отсутствие автоматического определения местоположения при открытии карты
**Приоритет:** Высокий  
**Предусловия:**
- Пользователь авторизован
- Разрешение на геолокацию предоставлено
- Маршрут загружен

**Шаги:**
1. Открыть приложение
2. Выбрать маршрут
3. Перейти на экран карты
4. Наблюдать за поведением карты

**Ожидаемый результат:**
- Местоположение НЕ определяется автоматически при открытии карты
- Карта центрируется на маршруте, а не на местоположении пользователя
- Кнопка определения местоположения доступна, но не активна автоматически

**Фактический результат:** [Заполняется тестировщиком]

---

### TC-LOC-002: Определение местоположения по нажатию кнопки
**Приоритет:** Высокий  
**Предусловия:**
- Карта открыта
- Разрешение на геолокацию предоставлено

**Шаги:**
1. Открыть карту с маршрутом
2. Нажать кнопку "Моё местоположение" (FAB в правом нижнем углу)
3. Дождаться определения местоположения

**Ожидаемый результат:**
- Местоположение определяется после нажатия кнопки
- Время определения местоположения приемлемое (не более 10 секунд)
- Карта центрируется на местоположении пользователя
- Маркер местоположения отображается на карте

**Фактический результат:** [Заполняется тестировщиком]

---

### TC-LOC-003: Скорость определения местоположения
**Приоритет:** Средний  
**Предусловия:**
- Карта открыта
- Разрешение на геолокацию предоставлено
- GPS включен

**Шаги:**
1. Открыть карту
2. Нажать кнопку определения местоположения
3. Засечь время от нажатия до появления маркера местоположения

**Ожидаемый результат:**
- Местоположение определяется быстро (в течение 5-10 секунд)
- Используется свежее местоположение или последнее известное (если свежее недоступно)
- При таймауте (10 секунд) возвращается последнее известное местоположение

**Фактический результат:** [Заполняется тестировщиком]

---

## Раздел 4: Маркер местоположения пользователя

### TC-LOC-MARKER-001: Отображение маркера местоположения
**Приоритет:** Высокий  
**Предусловия:**
- Карта открыта
- Местоположение определено

**Шаги:**
1. Открыть карту
2. Нажать кнопку определения местоположения
3. Дождаться определения местоположения
4. Найти маркер местоположения на карте

**Ожидаемый результат:**
- Маркер местоположения отображается как белый круг с красным кругом внутри
- Маркер имеет правильный размер (такой же как маркеры достопримечательностей, scale = 0.63f)
- Красный кружок занимает 80% пространства внутри белого кружка
- Маркер виден и хорошо различим на карте

**Фактический результат:** [Заполняется тестировщиком]

---

### TC-LOC-MARKER-002: Размер красного кружка в маркере местоположения
**Приоритет:** Средний  
**Предусловия:**
- Местоположение определено
- Маркер местоположения отображается

**Шаги:**
1. Открыть карту
2. Определить местоположение
3. Наблюдать за маркером местоположения

**Ожидаемый результат:**
- Красный кружок занимает 80% пространства внутри белого кружка
- Красный кружок хорошо виден
- Пропорции маркера выглядят гармонично

**Фактический результат:** [Заполняется тестировщиком]

---

### TC-LOC-MARKER-003: Обновление маркера местоположения
**Приоритет:** Средний  
**Предусловия:**
- Местоположение определено
- Маркер местоположения отображается
- Пользователь перемещается

**Шаги:**
1. Открыть карту
2. Определить местоположение
3. Переместиться в другое место (или дождаться обновления GPS)
4. Наблюдать за маркером местоположения

**Ожидаемый результат:**
- Маркер местоположения обновляется при изменении местоположения
- Старый маркер удаляется, новый добавляется
- Маркеры достопримечательностей не затрагиваются при обновлении маркера местоположения

**Фактический результат:** [Заполняется тестировщиком]

---

## Раздел 5: Центрирование карты

### TC-MAP-CENTER-001: Центрирование карты на маршруте при открытии
**Приоритет:** Высокий  
**Предусловия:**
- Маршрут загружен
- Карта открывается впервые

**Шаги:**
1. Открыть приложение
2. Выбрать маршрут
3. Перейти на экран карты
4. Наблюдать за начальным видом карты

**Ожидаемый результат:**
- Карта центрируется на маршруте при открытии
- Карта НЕ показывает весь мир
- Видны маршрут и достопримечательности
- Масштаб карты подходящий для просмотра маршрута (zoom ~13)

**Фактический результат:** [Заполняется тестировщиком]

---

### TC-MAP-CENTER-002: Центрирование карты на местоположении по кнопке
**Приоритет:** Высокий  
**Предусловия:**
- Карта открыта
- Местоположение определено

**Шаги:**
1. Открыть карту с маршрутом
2. Нажать кнопку определения местоположения
3. Дождаться определения местоположения

**Ожидаемый результат:**
- Карта центрируется на местоположении пользователя после нажатия кнопки
- Масштаб карты подходящий для просмотра местоположения (zoom ~15)
- Анимация центрирования плавная

**Фактический результат:** [Заполняется тестировщиком]

---

## Раздел 6: Кнопка определения местоположения

### TC-LOC-BTN-001: Отображение кнопки только на карте
**Приоритет:** Высокий  
**Предусловия:**
- Карта открыта
- Карточка достопримечательности может быть открыта

**Шаги:**
1. Открыть карту с маршрутом
2. Убедиться, что карточка достопримечательности закрыта
3. Проверить наличие кнопки определения местоположения
4. Открыть карточку достопримечательности (кликнуть на маркер)
5. Проверить наличие кнопки определения местоположения

**Ожидаемый результат:**
- Кнопка определения местоположения видна на карте, когда карточка достопримечательности закрыта
- Кнопка определения местоположения НЕ видна, когда карточка достопримечательности открыта
- Кнопка не перекрывает карточку достопримечательности

**Фактический результат:** [Заполняется тестировщиком]

---

### TC-LOC-BTN-002: Позиция кнопки определения местоположения
**Приоритет:** Средний  
**Предусловия:**
- Карта открыта
- Карточка достопримечательности закрыта

**Шаги:**
1. Открыть карту
2. Найти кнопку определения местоположения
3. Проверить её позицию

**Ожидаемый результат:**
- Кнопка находится в правом нижнем углу карты
- Кнопка поднята выше (padding bottom = 24.dp вместо 16.dp)
- Кнопка не перекрывает другие элементы интерфейса
- Кнопка хорошо видна и доступна для нажатия

**Фактический результат:** [Заполняется тестировщиком]

---

## Раздел 7: Адаптивные карточки описания маршрута

### TC-CARD-001: Адаптация карточек к маленькому размеру шрифта
**Приоритет:** Средний  
**Предусловия:**
- Пользователь авторизован
- Выбран маленький размер шрифта в настройках

**Шаги:**
1. Открыть настройки приложения
2. Выбрать "Маленький" размер шрифта
3. Вернуться назад
4. Выбрать маршрут
5. Открыть экран с описанием маршрута
6. Наблюдать за карточками с описанием

**Ожидаемый результат:**
- Карточки "Описание маршрута", "История маршрута", "Описание достопримечательностей" адаптируются к маленькому размеру шрифта
- Padding карточек уменьшается пропорционально размеру шрифта
- Текст не выглядит слишком маленьким в больших рамках
- Карточки выглядят гармонично

**Фактический результат:** [Заполняется тестировщиком]

---

### TC-CARD-002: Адаптация карточек к среднему размеру шрифта
**Приоритет:** Средний  
**Предусловия:**
- Пользователь авторизован
- Выбран средний размер шрифта в настройках

**Шаги:**
1. Открыть настройки приложения
2. Выбрать "Средний" размер шрифта
3. Вернуться назад
4. Выбрать маршрут
5. Открыть экран с описанием маршрута
6. Наблюдать за карточками с описанием

**Ожидаемый результат:**
- Карточки имеют стандартный размер padding
- Текст читается комфортно
- Карточки выглядят гармонично

**Фактический результат:** [Заполняется тестировщиком]

---

### TC-CARD-003: Адаптация карточек к большому размеру шрифта
**Приоритет:** Средний  
**Предусловия:**
- Пользователь авторизован
- Выбран большой размер шрифта в настройках

**Шаги:**
1. Открыть настройки приложения
2. Выбрать "Большой" размер шрифта
3. Вернуться назад
4. Выбрать маршрут
5. Открыть экран с описанием маршрута
6. Наблюдать за карточками с описанием

**Ожидаемый результат:**
- Карточки адаптируются к большому размеру шрифта
- Padding карточек увеличивается пропорционально размеру шрифта
- Текст читается комфортно
- Карточки не выглядят переполненными

**Фактический результат:** [Заполняется тестировщиком]

---

## Раздел 8: Интеграционные тесты

### TC-INT-001: Полный сценарий использования карты
**Приоритет:** Высокий  
**Предусловия:**
- Пользователь авторизован
- Разрешение на геолокацию предоставлено

**Шаги:**
1. Запустить приложение (проверить отсутствие экрана авторизации)
2. Выбрать маршрут "Автобус Б"
3. Перейти на экран карты
4. Проверить центрирование карты на маршруте
5. Проверить отображение маркеров достопримечательностей
6. Нажать на маркер достопримечательности
7. Проверить, что кнопка определения местоположения скрыта
8. Закрыть карточку достопримечательности
9. Проверить, что кнопка определения местоположения видна
10. Нажать кнопку определения местоположения
11. Проверить отображение маркера местоположения
12. Проверить, что маркеры достопримечательностей остались на месте

**Ожидаемый результат:**
- Все шаги выполняются без ошибок
- Все элементы интерфейса работают корректно
- Маркеры отображаются правильно
- Кнопки работают как ожидается

**Фактический результат:** [Заполняется тестировщиком]

---

### TC-INT-002: Смена размера шрифта во время использования
**Приоритет:** Низкий  
**Предусловия:**
- Пользователь авторизован
- Открыт экран с описанием маршрута

**Шаги:**
1. Открыть экран с описанием маршрута
2. Запомнить размер карточек
3. Открыть настройки
4. Изменить размер шрифта
5. Вернуться на экран с описанием маршрута
6. Проверить размер карточек

**Ожидаемый результат:**
- Карточки адаптируются к новому размеру шрифта
- Изменения применяются сразу
- Интерфейс остается читаемым

**Фактический результат:** [Заполняется тестировщиком]

---

## Раздел 9: Граничные случаи

### TC-EDGE-001: Маршрут без достопримечательностей
**Приоритет:** Средний  
**Предусловия:**
- Маршрут загружен, но не содержит достопримечательностей

**Шаги:**
1. Загрузить маршрут без достопримечательностей
2. Открыть карту
3. Наблюдать за поведением

**Ожидаемый результат:**
- Карта отображается корректно
- Маршрут (polyline) отображается
- Маркеры достопримечательностей не отображаются (что правильно)
- Приложение не падает

**Фактический результат:** [Заполняется тестировщиком]

---

### TC-EDGE-002: Отсутствие разрешения на геолокацию
**Приоритет:** Высокий  
**Предусловия:**
- Разрешение на геолокацию не предоставлено

**Шаги:**
1. Открыть карту
2. Нажать кнопку определения местоположения
3. Отказать в предоставлении разрешения

**Ожидаемый результат:**
- Запрашивается разрешение на геолокацию
- При отказе приложение продолжает работать
- Кнопка определения местоположения остается доступной для повторного запроса

**Фактический результат:** [Заполняется тестировщиком]

---

### TC-EDGE-003: GPS выключен
**Приоритет:** Средний  
**Предусловия:**
- Разрешение на геолокацию предоставлено
- GPS выключен

**Шаги:**
1. Выключить GPS на устройстве
2. Открыть карту
3. Нажать кнопку определения местоположения

**Ожидаемый результат:**
- Приложение пытается определить местоположение
- При таймауте возвращается последнее известное местоположение (если есть)
- Приложение не падает
- Показывается соответствующее сообщение или используется последнее известное местоположение

**Фактический результат:** [Заполняется тестировщиком]

---

## Раздел 10: Производительность

### TC-PERF-001: Производительность при большом количестве маркеров
**Приоритет:** Средний  
**Предусловия:**
- Маршрут содержит большое количество достопримечательностей (18+)

**Шаги:**
1. Загрузить маршрут с большим количеством достопримечательностей
2. Открыть карту
3. Наблюдать за производительностью при:
   - Открытии карты
   - Прокрутке карты
   - Масштабировании карты
   - Обновлении местоположения

**Ожидаемый результат:**
- Карта работает плавно без лагов
- Все маркеры отображаются корректно
- Производительность приемлемая

**Фактический результат:** [Заполняется тестировщиком]

---

## Чек-лист для быстрой проверки

- [ ] Маркеры достопримечательностей отображаются на карте
- [ ] Маркеры имеют золотистый цвет
- [ ] Размер маркеров достопримечательностей правильный (63% от исходного)
- [ ] Маркеры не исчезают при обновлении местоположения
- [ ] Экран авторизации не показывается для авторизованного пользователя
- [ ] Местоположение не определяется автоматически при открытии карты
- [ ] Карта центрируется на маршруте при открытии
- [ ] Маркер местоположения отображается как белый круг с красным кругом внутри
- [ ] Красный кружок занимает 80% пространства в белом кружке
- [ ] Кнопка определения местоположения видна только на карте, не на карточке достопримечательности
- [ ] Кнопка определения местоположения поднята выше
- [ ] Карточки описания маршрута адаптируются к размеру шрифта
- [ ] Определение местоположения работает быстро (до 10 секунд)

---

## Примечания

1. Все тесты должны выполняться на реальном устройстве или эмуляторе с включенным GPS
2. Для проверки авторизации рекомендуется очищать данные приложения между тестами
3. Для проверки размера шрифта необходимо менять настройки в приложении
4. Логи можно проверить через `adb logcat | grep YandexMapView` для отладки проблем с маркерами
5. При тестировании производительности рекомендуется использовать устройства с разной производительностью

---

## История изменений

| Дата | Версия | Изменения | Автор |
|------|--------|-----------|-------|
| 2026-01-22 | 1.0 | Создание тест-кейсов для исправлений маркеров и авторизации | AI Assistant |
